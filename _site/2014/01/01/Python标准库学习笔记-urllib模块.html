<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/tomorrow-night.css" media="screen" />
    <script src="/javascripts/highlight.pack.js"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>python标准库学习笔记 urllib模块</title>
    <script>
        hljs.tabReplace = '';
        hljs.initHighlightingOnLoad();
    </script>

  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Yiner in Python</h1>
        </header>


        <hr>

        <section id="main_content">
            <p>利用缓存实现简单的获取</p>

<pre><code>import urllib
import os

def reporthook(blocks_read,block_size,total_size):
    if not blocks_read:
        print 'Connection opened'
        return
    if total_size &lt; 0:
        print 'Read %d blocks ( %d bytes ) '%(blocks_read,blocks_read*block_size)
    else:
        amount_read = blocks_read*block_size
        print 'Read %d blocks,or %d / %d'%\
        (blocks_read,amount_read,total_size)

try:
    filename,msg = urllib.urlretrieve('http://zt.xiaomi.com/bbszt/rom/miuiv4_ics7.0/miuiV4_Mioneplus_ICS7.0_4.0_fastboot_dj8428bjkq.exe',
    reporthook=reporthook)

    print 
    print 'File:',filename
    print 'Headers'
    print msg
    print 'File exists before cheanup',os.path.exists(filename)

finally:
    #urllib.urlcleanup()

    print ' File still exists:', os.path.exists(filename)</code></pre>

<p>参数编码：</p>

<pre><code>import urllib

query_args = {'q':'query string','foo':'bar'}

encoded_args = urllib.urlencode(query_args)

print 'Encoded:',encoded_args 

query_args = {'q':['query string','bar']}

print urllib.urlencode(query_args,doseq=True)#同一个名称与多个值关联 doseq = True	</code></pre>

<p>路径与URL转换</p>

<pre><code>import os

from urllib import pathname2url,url2pathname

print '== Windows =='
path = r'\a\b\c'#不包含驱动器字母
print 'Original:',path
print 'URL     :',pathname2url(path)
print 'Path    :',url2pathname('/d/e/f')

print 

path = r'C:\a\b\c'#包含驱动器字母
print 'Original:',path
print 'URL     :',pathname2url(path)</code></pre>
        </section>

        <footer>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
