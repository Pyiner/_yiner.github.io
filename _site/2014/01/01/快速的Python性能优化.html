<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/tomorrow-night.css" media="screen" />
    <script src="/javascripts/highlight.pack.js"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>快速的Python性能优化(翻译)</title>
    <script>
        hljs.tabReplace = '';
        hljs.initHighlightingOnLoad();
    </script>

  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Yiner in Python</h1>
        </header>


        <hr>

        <section id="main_content">
            <p>在微博上看到了一遍文章，然后就试着翻译了一下，有些地方看不懂，就直接贴原文了，还望能看懂的人指点一下。</p>

<p># 快速的Python性能优化 #</p>

<p>1.%timeit (per line) and %prun (cProfile) in ipython interactive shell.</p>

<pre><code>Profile your code while working on it, and try to find of where is the bottleneck. This is not contrary to the fact that premature optimization is the root of all evil. This is mean for the first level optimization and not a heavy optimization sequence.
For more on profiling python code, you should read this: http://www.huyng.com/posts/python-performance-analysis/
Another interesting library, line_profiler is for line by line profiling https://bitbucket.org/robertkern/line_profiler</code></pre>

<p>2.减少函数的调用次数</p>

<pre><code>如果需要对一个list进行操作，向函数传入一个list要比每个元素调用一次函数快。</code></pre>

<p>3.使用xrange代替range ##</p>

<pre><code>xrange是range的C实现，更高效的使用内存</code></pre>

<p>4.对于大数据，使用numpy要比标准数据结构快</p>

<p>5.”“.join(string) 比 + 或者 += 好</p>

<p>6.while 1 比 while True 快</p>

<p>7.列表推导式 &gt; for 循环 &gt; while 循环</p>

<pre><code>列表推导式比for循环快，while循环是最慢的，因为while使用外部计数器</code></pre>

<p>8.使用 cProfile, cStringIO 和 cPickle</p>

<pre><code>始终使用可用的C版本的模块。</code></pre>

<p>9.使用局部变量 局部变量比全局变量，宏和属性查找快</p>

<p>10.ist and iterators versions exist - iterators are memory efficient and scalable. Use itertools</p>

<pre><code>Create generators and use yeild as much as posible. They are faster compared to the normal list way of doing it.</code></pre>

<p>11.在所有可能的地方，使用 Map, Reduce and Filter 代替循环. 12.对于检查’a in b’的地方, dict or set 比 list/tuple好.</p>

<p>13.对于大数据，尽可能的使用不可变类型，这样更快 tuples&gt;list</p>

<p>14.insertion into a list in O(n) complexity.</p>

<p>15.如果要从首尾操作列表，使用双端队列</p>

<p>16.使用del删除使用后的对象</p>

<pre><code>Python does it by itself. But make sure of that with the gc module or 
by writing an __del__ magic function or 
the simplest way, del after use.</code></pre>

<ol>
<li>time.clock()</li>
</ol>

<p>18.GIL(http://wiki.python.org/moin/GlobalInterpreterLock) - GIL is a demon.</p>

<pre><code>GIL allows only one python native thread to be run per process, preventing CPU level parallelism. Try using ctypes and native C libararies to overcome this. When even you reach the end of optimizing with python, always there exist an option of rewriting terribly slow functions in native C, and using it through python C bindings. Other libraries like gevent is also attacking the problem, and is successful to some extend.</code></pre>

<p>TL,DR: While you write code, just give one round of thought on the data structures, the iteration constructs, builtins and create C extensions for tricking the GIL if need.</p>

<p>原文链接<a href="http://infiniteloop.in/blog/quick-python-performance-optimization-part-i/">http://infiniteloop.in/blog/quick-python-performance-optimization-part-i/</a></p>
        </section>

        <footer>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
